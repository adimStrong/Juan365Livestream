# Juan365 Report Update Instructions

## Data Sources Overview

| Data | Source | How to Update |
|------|--------|---------------|
| **Reach** | CSV (Meta Business Suite export) | Manual export required |
| **Post Views** | CSV (Meta Business Suite export) | Manual export required |
| **Reactions/Comments/Shares** | API (automatic) | Run REFRESH_DATA.bat |
| **Reaction Breakdown** (Like/Love/Haha/Wow/Sad/Angry) | API (automatic) | Run REFRESH_DATA.bat |
| **Video Views** | API (automatic) | Run REFRESH_DATA.bat |
| **Followers/Rating** | API (automatic) | Run REFRESH_DATA.bat |

**Note:** If you don't need Reach/Views data, you can skip CSV updates entirely!

---

## Quick Update (Recommended)

### Option 1: Double-click REFRESH_DATA.bat
1. Navigate to `C:\Users\us\Desktop\juan365_engagement_project`
2. Double-click **REFRESH_DATA.bat**
3. Wait for all 3 steps to complete
4. Refresh your browser at http://localhost:8501

---

## Step-by-Step Manual Update

If the batch file doesn't work, follow these steps:

### Step 1: Open Command Prompt
1. Press `Win + R`
2. Type `cmd` and press Enter
3. Navigate to project folder:
   ```
   cd C:\Users\us\Desktop\juan365_engagement_project
   ```

### Step 2: Fetch Latest Posts & Videos
```
python api_fetcher.py
python refresh_api_cache.py
```
This fetches:
- All posts with reactions, comments, shares
- Video views
- Stories
- Page info (followers, rating)

### Step 3: Update Reaction Breakdown
```
python fetch_historical_reactions.py
```
This fetches Like/Love/Haha/Wow/Sad/Angry for all posts.
- First run: Takes 5-10 minutes (fetches all 800+ posts)
- Subsequent runs: Only fetches new posts (fast)

### Step 4: Push to Streamlit Cloud (Optional)
```
git add api_cache/
git commit -m "Update data"
git push
```

### Step 5: View Updated Report
- **Local**: http://localhost:8501
- **Cloud**: https://juan365-socmed-mainpage.streamlit.app

---

## Updating CSV (Only if you need Reach/Views)

The CSV is only needed if you want **Reach** and **Post Views** data.
If you don't need these metrics, skip this section!

### Step 1: Export from Meta Business Suite

1. Go to https://business.facebook.com/latest/insights/content
2. Select **Juan365** page
3. Click **Export** button (top right)
4. Choose date range (e.g., Dec-01-2025 to Dec-05-2025)
5. Download the CSV file
6. Save to `C:\Users\us\Desktop\juan365_engagement_project\exports\`
   - Keep the original filename (e.g., `Dec-01-2025_Dec-05-2025_123456789.csv`)

### Step 2: Merge CSV Files

After adding new CSV exports, double-click **MERGE_CSV.bat** or run:

```
cd C:\Users\us\Desktop\juan365_engagement_project
python merge_exports.py
```

This will:
- Read all CSV files in `exports/` folder
- Combine them into one file
- Remove duplicate posts
- Save to `Juan365_MERGED_ALL.csv`

### Current CSV Files

The exports folder should contain monthly CSVs like:
```
exports/
├── Jun-01-2025_Aug-31-2025_xxx.csv   (June-August)
├── Sep-01-2025_Sep-30-2025_xxx.csv   (September)
├── Oct-01-2025_Oct-31-2025_xxx.csv   (October)
├── Nov-01-2025_Dec-03-2025_xxx.csv   (November-December)
├── [NEW EXPORT].csv                   (Add new ones here)
└── Juan365_MERGED_ALL.csv            (Auto-generated by merge script)
```

### CSV Columns Required

The dashboard expects these columns in the CSV:
- `Post ID` - Post identifier
- `Reach` - Number of people who saw the post
- `Views` or `Views (Total)` - Video/reel views
- `Reactions` - Total reactions
- `Comments` - Comment count
- `Shares` - Share count
- `Publish time` - Date/time published
- `Post type` - Photo, Video, Reel, etc.

---

## Troubleshooting

### Error: "No module named 'requests'"
```
pip install requests
```

### Error: "Access token expired"
The page token is permanent and should not expire. If you see token errors:
1. Check `config.py` has the correct PAGE_TOKEN
2. Verify the token at: https://developers.facebook.com/tools/debug/accesstoken

### Error: "Rate limit exceeded"
Facebook API has rate limits. Wait 1 hour and try again.

### Streamlit not running locally
```
python -m streamlit run streamlit_app.py
```

### Data not updating on Streamlit Cloud
Make sure to push changes:
```
git add api_cache/
git commit -m "Update data"
git push
```
Wait 1-2 minutes for auto-deploy.

---

## Files Updated by Refresh

| File | Description |
|------|-------------|
| `api_cache/posts.json` | All posts with engagement |
| `api_cache/videos.json` | Video/reel views |
| `api_cache/stories.json` | Stories data |
| `api_cache/page_info.json` | Followers, rating |
| `api_cache/posts_reactions_full.json` | Reaction breakdown (Like/Love/Haha/Wow/Sad/Angry) |
| `api_cache/all_api_data.json` | Combined data for dashboard |

---

## Recommended Update Schedule

| Frequency | What to Run |
|-----------|-------------|
| Daily | `REFRESH_DATA.bat` (for latest posts) |
| Weekly | `git push` to update Streamlit Cloud |

---

## Project Structure

```
juan365_engagement_project/
├── api_cache/              # Cached API data (auto-updated)
├── assets/                 # Logo and images
├── streamlit_app.py        # Main dashboard
├── api_fetcher.py          # Fetches posts, videos, page info
├── refresh_api_cache.py    # Combines API data
├── fetch_historical_reactions.py  # Fetches reaction breakdown
├── config.py               # API credentials (DO NOT SHARE)
├── REFRESH_DATA.bat        # One-click update script
└── requirements.txt        # Python dependencies
```

---

## Contact

For issues with the Facebook API or dashboard, check:
- Facebook Graph API Explorer: https://developers.facebook.com/tools/explorer
- Streamlit Cloud Dashboard: https://share.streamlit.io
